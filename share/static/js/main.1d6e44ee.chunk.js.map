{"version":3,"sources":["Avatar.js","Alert.js","server_api.js","Login.js","Navbar.js","ProjectWithFolders.js","ProjectsList.js","FileDropzone.js","File.js","TimeLeft.js","FolderStats.js","Breadcrumbs.js","Folder.js","User.js","NewProject.js","Project.js","index.js","App.js"],"names":["Avatar","props","url","crypto","createHash","update","email","trim","toLocaleLowerCase","digest","size","undefined","cls","className","react_default","a","createElement","src","height","alt","errorHandler","setAlert","msg","console","log","Alert","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","errormsg","setMsg","bind","assertThisInitialized","setState","role","Component","server_URL","fetchStatusCheck","response","status","json","Promise","reject","statusText","onError","text","message","server_api","getProjectsList","func","fetch","method","headers","content-type","Authorization","getToken","then","catch","getProject","proj_id","addProject","name","description","body","JSON","stringify","updateProject","id","deleteProject","addFolder","project_id","folder_name","project","deleteFolder","folder_id","getFolder","getUsersList","addUser","updateUserProjects","user_id","action","updateUserName","getMe","getUser","deleteUser","uploadFile","file","onProgress","onDone","req","XMLHttpRequest","responseType","upload","addEventListener","event","lengthComputable","loaded","total","onload","resonse","formData","FormData","append","open","setRequestHeader","send","fileDownloadURL","file_id","token","accessToken","idToken","me","expiresAt","LOGIN_URL","window","location","origin","pathname","CLIENT_ID","auth","auth0","WebAuth","domain","clientID","redirectUri","scope","loggedIn","authResult","expiresIn","Date","getTime","localStorage","setItem","isAuthenticated","checkSession","err","Login","_Component","logged_in","restoring_session","return_to","inputEmail","inputCode","wrong_email","code_sent","from","was_logged_before","getItem","removeItem","API","match","params","hash","parseHash","handleInputChange","performLogIn","inherits","createClass","key","value","_this$setState","target","defineProperty","_this2","passwordlessStart","connection","res","passwordlessLogin","verificationCode","preventDefault","no_user","react_router","to","onSubmit","width","type","placeholder","onChange","autoFocus","href","onClick","authorize","Logout","logout","returnTo","MenuItem","where","react_router_dom","Navbar","data-toggle","data-target","aria-controls","aria-expanded","aria-label","render","p","is_admin","formatter","buildFormatter","ruStrings","Folder","empty","files_num","icon","animated","animate","lib_default","date","updated","callback","NewFolder","autoComplete","onAdd","htmlFor","maxLength","onEdit","length","disabled","onCancel","ProjectName","new_folder","ProjectWithFolders","new_folder_name","onNewFolder","onButtonCancel","onButtonAdd","onButtonDelete","folderAdded","folderDeleted","folder","folders","i","splice","unshift","push","sorted","sort","b","FoldersArray","f","ProjectsList","projects","loading","map","prj","src_ProjectWithFolders_0","FileDropzone","hightlight","fileInputRef","React","createRef","openFileDialog","onFilesAdded","onDragOver","onDragLeave","onDrop","current","click","evt","files","array","item","dataTransfer","children","style","cursor","ref","multiple","File","queued","index","FileQueued","uploading","progress","Math","round","FileUploading","error","error_text","FileError","download","filesize","uploaded","user","FileNormal","Seconds","x","Minutes","FolderStats","stats","uploaded_so_far","percentage","time_left","uploading_now","total_to_upload","toFixed","upload_started","mseq","fsecs","fhours","fmins","hours","floor","mins","secs","TimeLeft","total_uploaded","Breadcrumbs","parent_id","parent_name","aria-current","onCancelFile","onFileUpoaded","onUploadProgress","onUploadError","onFileListLoaded","new_files","added_size","duplicate","j","old_state","concat","rollQueue","uploads","next","to_upload","abort","copy","FileDropzone_FileDropzone","UserDescription","editing","is_loaded","is_deleting","clb","onEditNameButton","onNameChangeButton","nameEdit","onCancelButton","onDeleteUser","User","is_deleted","cached_id","loadUserInfo","_this3","updateMe","_this4","NewProject","processing","processed","onCreate","onCreated","required","rows","NewUser","email_valid","e","m","emailIsValid","user_email","onNewUserButton","onCreateUserButton","user_name","ProjectDescription","folders_num","onEditDescButton","onDescChangeButton","descEdit","created","onDeleteProject","Project","participants","Set","users","moved_user","onAddUser","onProjectLoaded","onUserCreated","newstate","sel","add","delete","new_users","others","has","Project_User","ReactDOM","exact","path","component","Projects","Folder_Folder","Project_Project","User_User","Alert_Alert","document","getElementById"],"mappings":"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","file":"static/js/main.1d6e44ee.chunk.js","sourcesContent":["import React    from 'react';\nimport crypto   from 'crypto';\n\nexport default function Avatar(props) {\n    const md5 = crypto.createHash('md5').update(props.email.trim().toLocaleLowerCase()).digest('hex');\n    const url = 'https://www.gravatar.com/avatar/' + md5  + '?d=identicon';\n    const size = ( props.size === undefined ) ? '30px' : props.size+'px';\n    const cls = props.className || '';\n    return (<img src={url} height={size} alt='avatar' className={'rounded-circle '+cls} />);\n} ","import React, { Component } from 'react';\n\n// пока пустой указатель, инициализируем позже, когда создатся экземпляр реакт-класса\nlet errorHandler = null;\n\n// Обновляем состояние баннера на новый текст ошибки\nexport function setAlert (msg){\n    if (errorHandler === null)\n    {\n        if( msg !== null )\n            return console.log(\"Error: setAlert() called before instantiating <Alert />, ignored. Message: \", msg);\n        else\n            return;\n    }\n    errorHandler(msg);\n}\n\n// класс показывает баннер с ошибкой, если она установлена не в null\nexport default class Alert extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = { errormsg: null };\n\n        if ( errorHandler !== null )\n            console.log(\"Warning: there can be only one instance of <Alert /> in application.\");\n        errorHandler = this.setMsg.bind(this);\n    }\n\n    componentWillUnmount() {\n        errorHandler = null;\n    }    \n\n    setMsg(msg) {\n        this.setState({ errormsg: msg });\n    }\n\n    render () {\n        if (this.state.errormsg === null)\n            return ('');\n        else\n            return (<aside className=\"fixed-bottom bg-danger border border-white text-white p-2\" role=\"alert\"> {this.state.errormsg} </aside>);\n    }\n}\n","import { setAlert } from './Alert';\nimport { getToken } from './Login';\n\n//const server_URL = 'http://localhost:8000'; // сервер на локальной машине\nconst server_URL = 'https://tomater.synology.me:8000'; // NAS, опубликованный в интернет\n\n// стандартная функция обработки статуса ответа сервера\nfunction fetchStatusCheck(response){\n    switch (response.status) {\n        case 200:\n            return (response.json());\n        case 401:\n            // проблема с токеном аутентификации - надо идти снова к странице логина\n            return Promise.reject(\"Error 401: Token is not correct.\");\n        default:\n            return Promise.reject('Server reply: '+ response.status + '; ' + response.statusText);\n    }\n}\n\nfunction onError (msg){\n    let text = \"Server-api/onError: unknown type of error...\";\n    if (typeof msg == 'object')\n    {\n        console.log(msg); // TODO.. Remove?\n        text = msg.message; // ошибка от fetch?\n    }\n    else if (typeof msg == 'string'){\n      text = msg;\n    }\n    setAlert(text);\n}\n\nexport default {\n    // получение списка проектов с сервера\n    getProjectsList: (func) => {\n        setAlert(null);\n        return fetch(server_URL + \"/projects\", {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // получение описания проекта с сервера\n    getProject: (func, proj_id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/projects/\" + proj_id, {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // добавить новый проект\n    // {\n    //    name:        string,  // название нового проекта, до 50 символов. Не может быть пустым\n    //    description: string   // описание новго проектаб до 200 символов. Допускается пустое\n    // }\n    // Возвращает описание проекта\n    addProject: (func, name, description) => {\n        setAlert(null);\n        return fetch(server_URL + \"/projects\", {\n            method: 'post',\n            body: JSON.stringify({ name, description }),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // обновить описание проекта\n    // {\n    //    name:        string,  // новое название проекта, до 50 символов. Не может быть пустым\n    //    description: string   // новое описание проектаб до 200 символов. Допускается пустое\n    // }\n    // Возвращает описание проекта\n    updateProject: (func, id, name, description) => {\n        setAlert(null);\n        return fetch(server_URL + \"/projects/\" + id, {\n            method: 'put',\n            body: JSON.stringify({ name, description }),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // удалить проект\n    deleteProject: (func, id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/projects/\" + id, {\n            method: 'delete',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },    \n\n    // добавить новый фолдер к проекту\n    // На входе JSON в теле\n    // {\n    //    project: string,  // UUID родительского проекта\n    //    name:    string   // название для новой папки\n    // }    \n    addFolder: (func, project_id, folder_name) => {\n        setAlert(null);\n        return fetch(server_URL + \"/folders\", {\n            method: 'post',\n            body: JSON.stringify({project: project_id, name: folder_name}),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // удалить пустой фолдер \n    // На входе id\n    // На выходе тот же id, если все успешно\n    deleteFolder: (func, folder_id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/folders/\"+folder_id, {\n            method: 'delete',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then( json => func(json.id) )\n        .catch(onError);\n    },\n\n    // считать папку с файлами\n    // На входе id\n    // На выходе JSON про папку и все ее файлы\n    getFolder: (func, folder_id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/folders/\"+folder_id, {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // получить список всех пользователей\n    // На выходе JSON с массивом\n    getUsersList: (func) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users\", {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // Создать нового пользователя\n    // На входе JSON в теле\n    // {\n    //    name:    string   // имя пользователя (максимум 50 символов)\n    //    email:   string   // email (максимум 50 символов)\n    //    project: string   // uuid проекта, к которому даем права сразу\n    // }\n    // возвращает JSON c описанием нового пользователя\n    addUser: (func, name, email, project ) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users\", {\n            method: 'post',\n            body: JSON.stringify({name, email, project}),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n\n    // обновление информации о пользователе - пока только доступные проекты\n    // позже, возможно, профиль\n    // На входе JSON в теле\n    // {\n    //    project: string               // uuid проекта, к которому даем/забираем права сразу\n    //    action:  string (add|delete)  // забрать или добавить прав\n    // }\n    // не возвращаем ничего\n    updateUserProjects: (func, user_id, project, action ) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users/\" + user_id, {\n            method: 'put',\n            body: JSON.stringify({project, action}),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // обновление информации о пользователе - пока только доступные проекты\n    // позже, возможно, профиль\n    // На входе JSON в теле\n    // {\n    //    name: string               // имя, на которое заменяем старое (максимум 50 символов)\n    // }\n    // не возвращаем ничего\n    updateUserName: (func, user_id, name ) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users/\" + user_id, {\n            method: 'put',\n            body: JSON.stringify({name}),\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // получить информацию о текущем пользователе\n    getMe: (func) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users/me\", {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },\n\n    // получить информацию о текущем пользователе по ID\n    getUser: (func, user_id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users/\" + user_id, {\n            method: 'get',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },    \n\n    // удалить пользователя\n    deleteUser: (func, user_id) => {\n        setAlert(null);\n        return fetch(server_URL + \"/users/\" + user_id, {\n            method: 'delete',\n            headers: { 'content-type': 'application/json', 'Authorization': 'Bearer ' + getToken() }})\n        .then(fetchStatusCheck)\n        .then(func)\n        .catch(onError);\n    },    \n\n    // загрузить файл на сервер\n    // на входе - \n    //  id родительской папочки\n    //  объект file\n    //     - коллбек для отслеживания прогресса загрузки\n    //     - колбек на окончание загрузки\n    //     - колбек на ошибку загрузки\n    //\n    //  возращает ссылку на риквест (чтобы отменить можно было)\n    uploadFile: (folder_id, file, onProgress, onDone, onError) => {\n        const req = new XMLHttpRequest();\n        req.responseType = 'json';\n\n        req.upload.addEventListener(\"progress\", event => {\n            if (event.lengthComputable)\n                onProgress(file.name, (event.loaded / event.total) * 100);\n        });\n        \n        req.onload = function () {\n            if ( req.resonse === null )\n                onError(file.name, \"Ошибка загрузки\" );\n            else\n                onDone(file.name, req.response); \n        }\n\n        req.upload.addEventListener(\"error\", event => {\n            // пока не удалось найти хоть какие-то признаки,\n            // позвояющие идентифицировать ошибку \n            // возможные причины - сервер не отвечает, это не файл, а папка, к файлу нет доступа\n            onError(file.name, \"Ошибка загрузки\" );\n        });\n    \n        const formData = new FormData();\n        formData.append(\"file\", file, file.name);\n        formData.append(\"folder\", folder_id);\n    \n        req.open(\"POST\", server_URL + \"/files\");\n        req.setRequestHeader('Authorization', 'Bearer ' + getToken() );\n        req.send(formData);\n\n        return req;\n    },\n\n    // правльная ссылка на скачивание файла\n    fileDownloadURL: (file_id, token) => {\n        return (server_URL + '/files/' + file_id + '?token=' + token);\n    }\n};\n\n","import React, { Component } from 'react';\nimport { Redirect }         from \"react-router-dom\";\nimport auth0                from 'auth0-js';\nimport API                  from './server_api'\n\nimport './Login.css'\n\nlet accessToken = null;\nlet idToken     = null;\nlet me          = null;\nlet expiresAt   = 0;\n\nconst LOGIN_URL   = window.location.origin +  window.location.pathname;\nconst CLIENT_ID   = '7b4QizTZk0ptdfV5X3mcseQZJ0vLzJbB'; // API APP\nconst AUTH_DOMAIN = 'nodelfilms.eu.auth0.com';\n\nconst auth = new auth0.WebAuth({\n    domain:         AUTH_DOMAIN,\n    clientID:       CLIENT_ID,\n    redirectUri:    LOGIN_URL,\n    responseType:   'token id_token',\n    scope:          'openid profile email'\n});\n\nfunction loggedIn (authResult) {\n    // сохраняем данные из токена\n    expiresAt   = (authResult.expiresIn * 1000) + new Date().getTime();\n    accessToken = authResult.accessToken;\n    idToken     = authResult.idToken;\n    // Set isLoggedIn flag in localStorage\n    localStorage.setItem('isLoggedIn', 'true');\n}\n\nexport function getToken(){\n    return idToken;\n}\n\nexport function getMe(){\n    return me;\n}\n\nexport function updateMe(json){\n    me=json;\n}\n\nexport function isAuthenticated () {\n    if ( accessToken === null || me === null ) {\n        return false;\n    }\n    else {\n        const now = new Date().getTime();\n        // через 10 минут устареет? надо бы обновить. Обычно они на два часа выдаются\n        if ( now + 10*60*1000 >= expiresAt ) {\n            auth.checkSession({}, (err, authResult) => {\n                if (authResult && authResult.accessToken && authResult.idToken)\n                    loggedIn(authResult);\n            });\n        } \n        // пока считаем, что все норм, токен есть и он не очень старый, либо вот-вот обновится\n        return true;\n    }\n}\n\nexport class Login extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            logged_in:   isAuthenticated(), // есть ли уже токен доступа к серверу и  информация о пользователе ?\n\n            restoring_session: false,       // на время восстановления старой сессии не будем ничего рисовать на экране, чтобы не мелькало\n            return_to:   { pathname: '/' }, // куда вернемся после восстановления сессии - если не было сюда явного редиректа - вернемся в корень\n\n            inputEmail:  '',                // поля ввода в форме\n            inputCode:   '',\n\n            wrong_email: false,             // состояния UI\n            code_sent:   false,\n        };\n\n        // запоминаем, откуда нас сюда заредиректили, чтобы потом вернуться\n        if ( this.props.location.state !== undefined )\n            this.state.return_to =  this.props.location.state.from;\n\n        // может быть не аутентифицированы сейчас, но были при прошлом посещении страницы?\n        let was_logged_before = localStorage.getItem('isLoggedIn');\n        if ( accessToken === null &&  was_logged_before ) {\n            // флаг, предотвращающий мелькание экрана\n            this.state.restoring_session = true;\n            // на случай ошибки сбрасываем флаг наличия сессии, чтобы не было бесконечного цикла\n            localStorage.removeItem('isLoggedIn');\n            // пытаемся восстановить токен с сервера \n            auth.checkSession({}, (err, authResult) => {\n                if (authResult && authResult.accessToken && authResult.idToken) {\n                    loggedIn(authResult);\n                    API.getMe((json) => {\n                        me = json;\n                        this.setState({ logged_in: true })\n                    });\n                }\n                else\n                    // попытка залогиниться не прошла, рисуем форму логина\n                    this.setState({ restoring_session: false })\n            });\n        }\n\n        // странная ситуация - есть токен, но не загружена информация о себе - загружаем\n        if ( accessToken !== null && me === null ) {\n            API.getMe((json) => {\n                me = json;\n                this.setState({ logged_in: true })\n            });\n        }\n\n        // Вариант для HashRouter - обрабатываем callback от Auth0 с токеном в URL\n        if ( props.match.params.hash !== undefined ){\n            // флаг, предотвращающий мелькание экрана\n            this.state.restoring_session = true;\n            auth.parseHash( \n                { hash: '#access_token=' + props.match.params.hash },\n                (err, authResult) => {\n                    if ( authResult && authResult.accessToken && authResult.idToken ) {\n                        loggedIn(authResult);\n                        API.getMe((json) => {\n                            me = json;\n                            this.setState({ logged_in: true })\n                        });\n                    }\n                    else \n                        // попытка залогиниться не прошла, рисуем форму логина\n                        this.setState({ restoring_session: false })\n                }\n            );\n        }\n\n        this.handleInputChange = this.handleInputChange.bind(this);\n        this.performLogIn      = this.performLogIn.bind(this);\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        this.setState({ [target.id]: target.value, wrong_email: false });\n    }\n\n    performLogIn(event){\n        if ( this.state.code_sent === false ){ \n            auth.passwordlessStart({ \n                connection: 'email', \n                send: 'code', \n                email: this.state.inputEmail,\n            }, (err,res) => {\n                if ( err !== null )\n                    this.setState ({ code_sent: false, wrong_email: true });\n                else \n                    this.setState ({ code_sent: true, wrong_email: false });\n            });\n        }\n        else {\n            auth.passwordlessLogin({ \n                connection: 'email', \n                email: this.state.inputEmail,\n                verificationCode: this.state.inputCode,\n            }, (err,res) => {\n                console.log('err=', err);\n                console.log('res=', res);\n            });\n        }\n        event.preventDefault();\n    }\n    \n    render () {\n        const no_user = this.state.wrong_email;\n\n        if ( this.state.logged_in )\n            return <Redirect to={this.state.return_to} />;\n        else if ( this.state.restoring_session )\n            return <center><h4 className='p-4 text-muted'>Logging in, please wait...</h4></center> ; // не мелькаем экраном на вермя восстановления сессии\n        else\n            return (\n            <main>\n                <form className=\"form-signin text-center my-5\" onSubmit = { this.performLogIn }>\n                    <img className=\"mb-4\" src=\"https://www.nodelfilms.com/assets/icons/nodelfilms-icon.svg\" alt=\"\" width=\"72\" height=\"72\" />\n                    <h1 className=\"h3 mb-3 font-weight-normal\">\n                        Вход только для зарегистрированны пользователей\n                    </h1>\n                    {\n                        this.state.code_sent && \n                        <p className='text-secondary'>\n                            Код подтверждения отправлен на указанную почту. Для входа, введите код в поле ниже:\n                        </p>\n                    }\n                    <div className=\"input-group\">\n                        { this.state.code_sent || \n                            <div className=\"input-group-prepend\">\n                                <span className=\"input-group-text\">@</span>\n                            </div>\n                        }\n                    <input type= { this.state.code_sent ? 'hidden' : 'email' }\n                           id=\"inputEmail\" \n                           className={no_user ? \"form-control is-invalid\" : \"form-control\"}\n                           placeholder=\"Email\" \n                           value={this.state.inputEmail} \n                           onChange={this.handleInputChange}\n                           autoFocus={true}/>\n                    { no_user &&\n                        <div className=\"invalid-feedback\">\n                            Пользователь не зарегистрирован\n                        </div>\n                    }\n                    </div>\n                    <input type={ this.state.code_sent ? 'number' : 'hidden' }\n                           id=\"inputCode\" \n                           className=\"form-control\" \n                           placeholder=\"Код из письма\" \n                           value={this.state.inputCode} \n                           onChange={this.handleInputChange}\n                           autoFocus={true}/>\n                    <button className=\"btn btn-primary btn-block my-2\" type=\"submit\">\n                        { this.state.code_sent ? ' Проверить код' : ' Получить код для входа' }\n                    </button>\n                    <small>\n                        <a href=\"/\" onClick={ (event)=>{ auth.authorize(); event.preventDefault(); } }>\n                            Вход по паролю\n                        </a>\n                    </small>\n                    <p className=\"mt-5 mb-3 text-muted\">\n                        © 2019, nodelfilms.com\n                    </p>\n                </form>\n            </main> \n        );\n    }    \n}\n\nexport function Logout (props) {\n    if ( accessToken !== null ){\n        // Remove isLoggedIn flag from localStorage\n        me = null;\n        localStorage.removeItem('isLoggedIn');\n        auth.logout( { returnTo: LOGIN_URL, clientID: CLIENT_ID });\n    }\n    // это будет отображено на экране на короткое время, \n    // пока идет запрос к серверу авторизации\n    // потом будет редирект страницу логина\n    return (<center><h4 className='p-4 text-muted'>Logging out, please wait...</h4></center>);\n}","import React           from 'react';\nimport { Route, Link } from 'react-router-dom';\nimport Avatar          from './Avatar';\nimport { getMe }       from './Login';\n\nfunction MenuItem (props) {\n    if (props.where === props.to){\n        return (\n            <li className=\"nav-item active\">\n                <div className=\"nav-link\">{props.text}</div>\n            </li>\n        );\n    }\n    else {\n        return (\n            <li className=\"nav-item\">\n                <Link className=\"nav-link\" to={props.to}>{props.text}</Link>\n            </li>\n        );\n    }\n}\n\nexport default function Navbar(props) {\n    const me = ( props.me !== undefined ) ? props.me : getMe();\n    return (\n        <nav className=\"navbar navbar-expand-sm navbar-dark bg-dark\">\n            <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarNav\" aria-controls=\"navbarNav\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span className=\"navbar-toggler-icon\"></span>\n            </button>\n            <div className=\"collapse navbar-collapse\" id=\"navbarNav\">\n                <ul className=\"navbar-nav\">\n                    <Route render={ (p)=> <MenuItem where={p.location.pathname} text=\"Начало\" to=\"/\" /> } />\n                    { me.is_admin && \n                        <Route render={ (p)=> <MenuItem where={p.location.pathname} text=\"Новый проект\" to=\"/new_project\"  /> } /> }\n                    <Route render={ (p)=> <MenuItem where={p.location.pathname} text=\"Выйти\" to=\"/logout\"  /> } />\n                </ul>\n            </div>\n            <li className=\"navbar-text dropdown\">\n                <Avatar email={me.email} size='30' />\n                <span className='ml-2'><Link to={'/user/'+me.id} className='text-white-50'>{me.name}</Link></span>\n            </li>\n        </nav>\n    );\n}\n","import React, { Component } from 'react';\nimport { Link }             from 'react-router-dom';\n\nimport TimeAgo              from 'react-timeago';\nimport ruStrings            from 'react-timeago/lib/language-strings/ru'\nimport buildFormatter       from 'react-timeago/lib/formatters/buildFormatter'\n\nimport API                  from './server_api'\n\nimport './ProjectWithFolders.css';\n\nconst formatter = buildFormatter(ruStrings);\n\nfunction Folder(props) {\n    const empty = (props.files_num === 0);\n    const icon = empty ? \"img/folder-empty.svg\" : \"img/folder.svg\";\n    const animated = (props.animate===true) ? \"folder-animated \" : \"\";\n    return (\n        <div className={ animated + \"list-group-item\" } key={props.id}>\n            <div className=\"d-flex w-100 justify-content-between\">\n                <div className=\"media\">\n                    <Link to={\"/folder/\"+props.id} className=\"align-self-center\">\n                        <img src={icon} className=\"mr-3\" height=\"66\" alt=\"folder\" />\n                    </Link>\n                    <div className=\"media-body\">\n                        <Link to={\"/folder/\"+props.id} className='text-dark'>\n                            <h4 className=\"mt-0 mb-0 text-break\">{props.name}</h4>\n                        </Link>\n                        <small>\n                        { empty ? \n                            <p className=\"mb-0 text-secondary\">Нет файлов</p> :\n                            <p className=\"mb-0 text-secondary\">Файлов: {props.files_num}</p> \n                        } \n                        <p className=\"mb-0 text-secondary\">\n                            <TimeAgo date={props.updated} formatter={formatter} />\n                        </p>\n                        </small>\n                    </div>\n                </div>\n                { empty && <button type=\"button\" className=\"close\" onClick={props.callback} id={props.id}>&times;</button> }\n            </div>\n        </div>\n    );\n}\n\nfunction NewFolder(props) {\n    return (\n        <form className=\"form-inline mt-3\" autoComplete=\"off\" onSubmit={props.onAdd}>\n            <label className=\"sr-only\" htmlFor=\"folderName\">Name</label>\n            <input type=\"text\" maxLength=\"50\" className=\"form-control mb-2 mr-sm-2\" id=\"folderName\" \n                placeholder=\"Название папки\" onChange={props.onEdit} value={props.text}/>\n            { props.text.length >  0 ?\n                <button type=\"submit\" className=\"btn btn-primary btn-sm mb-2 mr-2\">Создать</button> :\n                <button type=\"submit\" className=\"btn btn-primary btn-sm mb-2 mr-2\" disabled>Создать</button>\n            }\n            <button className=\"btn btn-primary btn-sm mb-2\" onClick={props.onCancel}>Отмена</button>\n        </form>        \n    );\n}\n\nfunction ProjectName(props) {\n    return (\n        <div>\n            <div className=\"row mt-3\">\n                <div className=\"col-sm-8 mx-1\">\n                    <Link to={ '/project/' + props.id } className='text-dark mb-0'>\n                        <h2> {props.name}</h2>\n                    </Link>\n                </div>\n                <div className=\"col-sm mx-1 pt-sm-2 text-sm-right\">\n                    <small className=\"text-muted\"><TimeAgo date={props.updated} formatter={formatter}/></small>\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"col mx-1\">\n                    <p className=\"mb-0\">{props.description}</p>\n                </div>        \n            </div>\n            <div className=\"row\">\n                <div className=\"col mx-1\">\n                    { props.new_folder || <a href=\"/#\" onClick={props.onClick}><small>Добавить папку »</small></a> }\n                </div>        \n            </div>\n        </div>\n    );\n}\n\n\nclass ProjectWithFolders extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state              = props.project;\n        this.state.new_folder   = false;\n        this.state.new_folder_name = '';\n\n        this.onNewFolder        = this.onNewFolder.bind(this);\n        this.onCancel           = this.onButtonCancel.bind(this);\n        this.onAdd              = this.onButtonAdd.bind(this);\n        this.handleInputChange  = this.handleInputChange.bind(this);\n        this.onButtonAdd        = this.onButtonAdd.bind(this);\n        this.onButtonDelete     = this.onButtonDelete.bind(this);\n        this.onButtonCancel     = this.onButtonCancel.bind(this);\n        this.folderAdded        = this.folderAdded.bind(this);\n        this.folderDeleted      = this.folderDeleted.bind(this);\n    }\n\n    onNewFolder(event){\n        event.preventDefault();\n        this.setState({ new_folder: true, new_folder_name: '' });\n    }\n\n    onButtonAdd(event){\n        event.preventDefault();\n        this.setState({ new_folder: false });\n        API.addFolder(this.folderAdded, this.state.id, this.state.new_folder_name);\n    }\n\n    onButtonCancel(event){\n        event.preventDefault();\n        this.setState({ new_folder: false });\n    }\n\n    onButtonDelete(event){\n        event.preventDefault();\n        API.deleteFolder(this.folderDeleted, event.target.id);\n    }\n\n    folderAdded(folder){\n        let folders = this.state.folders;\n        // если создаем папку с дублирующимся имеем, сервер не создаст новую папку,\n        // а вернет уже существующую с тем же именем. проверяем уникальность\n        for (let i=0; i<folders.length; i++){\n            folders[i].animate = false;\n            if ( folders[i].id === folder.id ){\n                // удаляем, чтобы затем добавить на вершину списка\n                folders.splice(i,1);\n                i--;\n            }\n        }\n        // эту папочку нужно красиво появить на экране\n        folder.animate = true;\n        folders.unshift(folder);\n        this.setState({ folders: folders });\n    }\n\n    folderDeleted(id){\n        let folders = [];\n        // сохраняем все, кроме удаленной папки\n        for (let i in this.state.folders)\n            if ( this.state.folders[i].id !== id )\n                folders.push(this.state.folders[i]);\n        this.setState({ folders: folders });\n    }\n\n    handleInputChange(event) {\n        switch (event.target.id){\n            case 'folderName':\n                this.setState({ new_folder_name: event.target.value});\n                break;\n            default:\n        }\n    }    \n \n    render() {\n        // строим массив фолдеров\n        const sorted = this.state.folders.sort( (a,b)=>{ return new Date(b.updated)-new Date(a.updated);} );\n        const FoldersArray=[];\n        for (let i in sorted ){\n            // добавляем сслыку на колбэк\n            let f = sorted[i];\n            f.callback = this.onButtonDelete;\n            FoldersArray.push(Folder(f));\n        }\n        // рендерим\n        return (\n            <div className=\"mb-4\">\n                <ProjectName \n                    id={this.state.id} \n                    name={this.state.name} \n                    updated={this.state.updated} \n                    onClick={this.onNewFolder} \n                    new_folder={this.state.new_folder}/>\n                    \n                { this.state.new_folder && <NewFolder \n                    onAdd={this.onButtonAdd} \n                    onCancel={this.onButtonCancel} \n                    onEdit={this.handleInputChange} \n                    text={this.state.new_folder_name}/> }\n\n                <div className=\"list-group shadow mt-3\">\n                    {FoldersArray}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default ProjectWithFolders;\n","import React, { Component } from 'react';\nimport { Redirect }         from \"react-router-dom\";\n\nimport Navbar               from './Navbar';\nimport Project              from './ProjectWithFolders'\nimport API                  from './server_api'\nimport { isAuthenticated }  from './Login'\n\n\n// выводим подряд все проекты\nexport default class ProjectsList extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            projects: null,\n            loading:  true,  // пока еще загружаем список проектов\n        };\n    }\n    \n    componentWillMount() {\n        // Теперь время загрузить список проектов с сервера\n        if ( isAuthenticated() )\n            API.getProjectsList( (json)=>{this.setState({ projects: json, loading: false });} );\n    }\n\n    render () {\n        // неавторизованных пользователей перенаправляем на страницу логина\n        if ( !isAuthenticated() )\n            return (<Redirect to={{ pathname: \"/login\", state: { from: this.props.location }}} />);\n\n        let projects = [];\n        if ( this.state.projects !== null )\n            projects = this.state.projects.map( prj => { return <Project project={prj} key={prj.id}/>; } );\n\n        return ([\n            <Navbar key='navbar' />,\n            <main key='body' role=\"main\" className=\"container\">\n                {projects}\n                { this.state.loading || projects.length > 0 ||\n                    <center className=\"p-4\">\n                        <img className=\"m-4\" src=\"http://nodelfilms.com/assets/icons/nodelfilms-icon.svg\" alt=\"\" width=\"72\" height=\"72\" />\n                        <h3 >Вы сейчас не участвуете ни в одном из проектов.</h3>\n                        <p>Если это не так, то свяжитесь с нами, чтобы мы настроили Вам права доступа.</p>\n                    </center>                \n                }\n            </main>\n        ]);\n    }\n}\n","import React, { Component } from 'react';\n\nimport './FileDropzone.css';\n\nexport default class FileDropzone extends Component {\n    constructor(props) {\n        super(props)\n        this.state = { hightlight: \"\" };\n        this.fileInputRef = React.createRef();\n\n        this.openFileDialog = this.openFileDialog.bind(this);\n        this.onFilesAdded   = this.onFilesAdded.bind(this);\n        this.onDragOver     = this.onDragOver.bind(this);\n        this.onDragLeave    = this.onDragLeave.bind(this);\n        this.onDrop         = this.onDrop.bind(this);\n    }\n\n    openFileDialog() {\n        this.fileInputRef.current.click();\n    }\n\n    onFilesAdded(evt) {\n        // преобразуем список в обычный массив\n        const files = evt.target.files;\n        let array =[];\n        for (var i = 0; i < files.length; i++)\n            array.push(files.item(i));\n        // вызываем колбек\n        if (this.props.onFilesAdded)\n            this.props.onFilesAdded(array);\n    }\n\n    onDrop(event) {\n        event.preventDefault();\n        // преобразуем список в обычный массив\n        const files = event.dataTransfer.files;\n        let array =[];\n        for (var i = 0; i < files.length; i++)\n            array.push(files.item(i));\n        // вызываем колбек\n        if (this.props.onFilesAdded)\n            this.props.onFilesAdded(array);\n        this.setState({ hightlight: \"\" });\n    }\n\n    onDragOver(evt) {\n        evt.preventDefault();\n        this.setState({ hightlight: \"ZoneHighlight\" });\n    }\n\n    onDragLeave() {\n        this.setState({ hightlight: \"\" });\n    }\n  \n    render() {\n        return (\n            <div className={\"p-1 \" + this.state.hightlight } \n                onDragOver={this.onDragOver} \n                onDragLeave={this.onDragLeave} \n                onDrop={this.onDrop} >\n\n                {this.props.children}\n                \n                <div className=\"d-flex w-100 flex-column align-items-center my-4 p-4 Dropzone\">\n\n                    <img src=\"img/cloud-upload.svg\" \n                        alt=\"upload\" \n                        height=\"150\" \n                        onClick={this.openFileDialog} \n                        style={{ cursor: \"pointer\" }} />\n                    \n                    <input ref={this.fileInputRef} \n                        className=\"InvisibleFileInput\" \n                        type=\"file\" multiple \n                        onChange={this.onFilesAdded} />\n                    \n                    <button type=\"button\" \n                        className=\"btn btn-secondary btn-lg mb-3\" \n                        onClick={this.openFileDialog}>Загрузите файлы</button>\n                    \n                    <center><p>Или перетащите файлы сюда для закачки</p></center>\n                </div>\n            </div>\n        );\n    }\n}","import React    from 'react';\nimport filesize from 'filesize'\n\nimport TimeAgo              from 'react-timeago';\nimport ruStrings            from 'react-timeago/lib/language-strings/ru'\nimport buildFormatter       from 'react-timeago/lib/formatters/buildFormatter'\n\nimport API                  from './server_api'\n\nconst formatter = buildFormatter(ruStrings);\n\n\nfunction FileUploading(props) {\n    return (\n        <div className=\"d-flex w-100\">\n            <div className=\"align-self-center mx-3\">\n                <img src=\"img/cloud-upload-gray.svg\" height=\"50\" alt=\"upload\" />\n            </div>\n            <div className=\"d-flex w-100 flex-column flex-md-row align-items-md-center\">\n                <h4 className=\"text-dark my-0 mr-3 text-break text-muted\">\n                    {props.name}\n                </h4>\n                <div className=\"progress flex-grow-1 mr-2\" style={{height: \"22px\"}}>\n                    <div className=\"progress-bar progress-bar-striped progress-bar-animated\" \n                        style={{width: props.progress+\"%\"}}>\n                        {Math.round(props.progress) + \"%\"}\n                    </div>\n                </div>\n            </div>\n            <button type=\"button\" \n                className=\"close mr-2\" \n                onClick={props.callback} \n                id={props.index}>\n                    &times;\n            </button>\n        </div>\n    );\n}\n\nfunction FileQueued(props) {\n    return (\n        <div className=\"d-flex w-100\">\n            <div className=\"align-self-center mx-3\">\n                <img src=\"img/cloud-upload-light.svg\" height=\"50\" alt=\"upload\" />\n            </div>\n            <div className=\"d-flex w-100 flex-column flex-md-row align-items-md-center\">\n                <h4 className=\"text-dark my-0 mr-3 text-break text-muted\">\n                    {props.name}\n                </h4>\n                <small className=\"flex-grow-1 mr-2 text-secondary\">\n                    В очереди на загрузку\n                </small>\n            </div>\n            <button type=\"button\" \n                className=\"close mr-2\" \n                onClick={props.callback} \n                id={props.index}>\n                    &times;\n            </button>\n        </div>\n    );\n}\n\n\nfunction FileError(props) {\n    return (\n        <div className=\"d-flex w-100\">\n            <div className=\"align-self-center mx-3\">\n                <img src=\"img/error.svg\" height=\"50\" alt=\"upload\" />\n            </div>\n            <div className=\"d-flex w-100 flex-column flex-md-row align-items-md-center\">\n                <h4 className=\"text-dark my-0 mr-3 text-break text-muted\">\n                    {props.name}\n                </h4>\n                <small className=\"flex-grow-1 mr-2 text-secondary\">\n                    {props.error_text}\n                </small>\n            </div>\n            <button type=\"button\" \n                className=\"close mr-2\" \n                onClick={props.callback} \n                id={props.index}>\n                    &times;\n            </button>\n        </div>\n    );\n}\n\n\nfunction FileNormal(props) {\n    return (\n        <div className=\"d-flex w-100\">\n            <a download href={API.fileDownloadURL(props.id, props.token)} className=\"align-self-center mx-3\">\n                <img src=\"img/cloud-download.svg\" height=\"50\" alt=\"download\" />\n            </a>\n            <div className=\"d-flex w-100 flex-column flex-md-row align-items-md-center\">\n                <a download href={API.fileDownloadURL(props.id, props.token)} className=\"flex-grow-1 text-dark\">\n                    <h4 className=\"my-0 mr-2 text-break\">\n                        {props.name}\n                    </h4>\n                </a>\n                <div className=\"d-flex flex-column flex-md-row\">\n                    <small className=\"mx-md-2 mx-0 text-body text-break\">\n                        { filesize(props.size) }\n                    </small> \n                    <small className=\"mx-md-2 mx-0 text-secondary text-break\">\n                        <TimeAgo date={props.uploaded} formatter={formatter} />\n                    </small> \n                    <small className=\"mr-md-2 mx-0 text-secondary text-break\">\n                        {props.user}\n                    </small>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default function File(props) {\n    let file;\n    if (props.queued)\n        file = FileQueued(props);\n    else if (props.uploading)\n        file = FileUploading(props);\n    else if (props.error)\n        file = FileError(props);\n    else\n        file = FileNormal(props);\n    return (\n    <div key={props.index} className=\"list-group-item p-1\">\n        {file}\n    </div>);\n}\n","function Seconds(x) {\n    const last_digit = x %  10;\n\n    // 11,12,13,14 - исключения\n    if ( x>10 && x < 15 )\n        return x + ' секунд';\n\n    switch(last_digit){\n        case 1:\n            return x + ' секунда';\n        case 2:\n        case 3:\n        case 4:\n            return x + ' секунды';\n        default:\n            return x + ' секунд';\n    }\n}\n\nfunction Minutes(x) {\n    const last_digit = x %  10;\n\n    // 11,12,13,14 - исключения\n    if ( x>10 && x < 15 )\n        return x + ' минут';\n\n    switch(last_digit){\n        case 1:\n            return x + ' минута';\n        case 2:\n        case 3:\n        case 4:\n            return x + ' минуты';\n        default:\n            return x + ' минут';\n    }\n}\n\nexport default function TimeLeft(mseq) {\n    const fsecs  = mseq / 1000;\n    const fhours = fsecs / 3600;\n    const fmins  = fsecs / 60;\n    \n    const hours  = Math.floor(fhours);\n    const mins   = Math.floor(fmins) % 60;\n    const secs   = Math.floor(fsecs) % 60;\n\n    if (fhours >= 5)\n        return (hours + \" часов\"); // следующий падеж - 21 час, не поддерживаем пока\n    else if (fhours >= 2)\n        return (hours + \" часа \" + Minutes(mins));\n    else if (fhours >= 1)\n        return (\"1 час \" + Minutes(mins));\n    else if (mins >= 3)\n        return Minutes(mins);\n    else if (mins >= 1)\n        return (Minutes(mins) + ' ' + Seconds(secs));\n    else\n        return (Seconds(secs));\n\n}\n\n/*\nfunction test (h,m,s,ms){\n    let output = h+':'+m+':'+s+'('+ms+') ' \n        + TimeLeft(ms+1000*(s+60*(m+60*h)));\n    console.log(output);\n}\n\ntest(10,45,5,123);\ntest(4,45,5,123);\ntest(3,45,5,123);\ntest(2,45,5,123);\ntest(1,45,5,123);\ntest(0,45,5,123);\ntest(0,43,5,123);\ntest(0,41,5,123);\ntest(0,11,5,123);\ntest(0,3,0,123);\ntest(0,2,1,123);\ntest(0,2,2,123);\ntest(0,2,3,123);\ntest(0,2,5,123);\ntest(0,1,5,123);\ntest(0,0,5,123);\ntest(0,0,3,123);\ntest(0,0,1,123);\ntest(0,0,0,0);\n*/\n\n","import React      from 'react';\nimport filesize   from 'filesize';\n\nimport TimeLeft   from './TimeLeft';\n\n\nexport default function FolderStats(props) {\n    let progress = props.stats.uploaded_so_far;\n\n    // прогресс с учетом файлов, которые еще загружаются\n    for (let i in props.stats.files) {\n        const f = props.stats.files[i];\n        if (f.uploading) {\n            progress += f.size * f.progress / 100;\n        }\n    }\n\n    let percentage = 0, elapsed = 0, time_left = 0;\n    if (props.stats.uploading_now) {\n        // оставшийся процент\n        percentage = (100 * (props.stats.total_to_upload - progress) / props.stats.total_to_upload).toFixed(1);\n        // оставшееся время (в миллисекундах)\n        elapsed = (new Date()).getTime() - props.stats.upload_started.getTime();\n        time_left = elapsed / progress * (props.stats.total_to_upload - progress + 1);\n    }\n\n    return (<div className=\"d-flex flex-wrap w-100 justify-content-left my-2\">\n        <a href=\"/#\" className=\"mr-3 flex-grow-1\">\n            { props.stats.files.length > 0 &&  <small> Скачать все » </small> }\n        </a>\n        <div className=\"mx-1 text-body\">\n            {props.stats.uploading_now ?\n                <small>\n                    <span className=\"text-secondary\"> Загружаем </span>\n                    {filesize(props.stats.total_to_upload)}\n                    <span className=\"text-secondary\">, осталось </span>\n                    {percentage + '%, '}\n                    {TimeLeft(time_left)}\n                </small> :\n                <small>\n                    {props.stats.files.length}\n                    <span className=\"text-secondary\"> файла(ов), </span>\n                    {filesize(props.stats.total_uploaded)}\n                </small>}\n        </div>\n    </div>);\n}\n","import React     from 'react';\nimport { Link }  from \"react-router-dom\";\n\nexport default function Breadcrumbs(props) {\n    return (<nav aria-label=\"breadcrumb\">\n        <ol className=\"breadcrumb mb-2\">\n            <li className=\"breadcrumb-item\"><Link to=\"/\">Все проекты</Link></li>\n            { props.parent_id !== undefined &&\n                <li className=\"breadcrumb-item\"><Link to={\"/project/\" + props.parent_id}>{props.parent_name}</Link></li>\n            }\n            <li className=\"breadcrumb-item active\" aria-current=\"page\">{props.name}</li>\n        </ol>\n    </nav>);\n}\n","import React, { Component } from 'react';\nimport { Redirect }         from \"react-router-dom\";\nimport Navbar               from './Navbar';\nimport FileDropzone         from './FileDropzone';\nimport File                 from './File';\nimport API                  from './server_api'\nimport FolderStats          from './FolderStats';\nimport Breadcrumbs          from './Breadcrumbs';\nimport { isAuthenticated }  from './Login'\n\n\n\nexport default class Folder extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            name:            null,\n            parent_id:       null,\n            files:           [],\n            uploading_now:   false,\n            upload_started:  null,\n            uploaded_so_far: 0,\n            total_to_upload: 0,\n            total_uploaded:  0,\n         };\n\n        this.onFilesAdded     = this.onFilesAdded.bind(this);\n        this.onCancelFile     = this.onCancelFile.bind(this);\n        this.onFileUpoaded    = this.onFileUpoaded.bind(this);\n        this.onUploadProgress = this.onUploadProgress.bind(this);\n        this.onUploadError    = this.onUploadError.bind(this);\n        this.onFileListLoaded = this.onFileListLoaded.bind(this);\n    }\n\n    componentWillMount() {\n        if ( isAuthenticated() )\n            API.getFolder( this.onFileListLoaded, this.props.match.params.id );\n    }\n\n    onFileListLoaded(json){\n        let size=0;\n        for (let i in json.files)\n            size += json.files[i].size;\n        this.setState({\n            name:        json.name,\n            parent_id:   json.parent_id,\n            parent_name: json.parent_name,\n            files:       json.files,\n            total_uploaded: size,\n        });\n    }\n\n    onFilesAdded(files){\n        const new_files=[];\n        let added_size=0;\n        // Добавляем новые файлы в очередь на закачку\n        for (let i in files) {\n            // не позволяем заливать дубликаты\n            let duplicate = false;\n            for (let j in this.state.files){\n                if ( this.state.files[j].error !== true &&  this.state.files[j].name === files[i].name ) {\n                    duplicate = true;\n                    new_files.push({ name: files[i].name, error: true, error_text: \"Файл с таким именем уже есть в этой папке.\" });\n                    break;\n                }\n            }\n            // ставим в очередь на закачку\n            if ( duplicate === false ){\n                const file = { \n                    name: files[i].name,\n                    size: files[i].size,\n                    file: files[i],\n                    queued: true, \n                };\n                new_files.push(file);\n                added_size += files[i].size;\n            }\n        }\n        // асинхронно добавляем их к состоянию\n        this.setState( old_state => ({\n            files: old_state.files.concat(new_files),\n            total_to_upload: old_state.total_to_upload+added_size,\n        }));\n        // запускаем закачку следующих по очереди\n        this.rollQueue();\n    }\n\n    rollQueue(){\n        // делаем обновление асинхронно\n        if ( isAuthenticated() ) // нужно регулярно вызывать этот метод, чтобы обнолять устаревающие токены\n            this.setState( old_state => {\n\n            const files = old_state.files;\n            // считаем количество текущих закачек\n            let uploads = 0;\n            for (let i in files)\n                if ( files[i].uploading )\n                    uploads++;\n\n            // запускаем новые, если нужно\n            while (uploads < 3){\n                // ищем следующую в очереди\n                let next = null;\n                for(let i in files){\n                    if ( files[i].queued ){\n                        next = i;\n                        break;\n                    }\n                }\n\n                // выходим, если очередь закончилась\n                if (next === null)\n                    break;\n\n                // запускаем реальную загрузку\n                const ref = API.uploadFile(this.props.match.params.id, files[next].file, this.onUploadProgress, this.onFileUpoaded, this.onUploadError);\n\n                // добавляем в табличку новую загрузку\n                files[next] = { \n                    name: files[next].name,\n                    size: files[next].size,\n                    uploading: true, \n                    progress: 0,\n                    ref,\n                };\n                uploads++;\n            }\n            \n            // если это самое начало - инициализируем статистику\n            if ( (!old_state.uploading_now) && uploads > 0 ){\n                // считаем полный объем данных для закачки\n                let to_upload = 0;\n                for (let i in files)\n                    if ( files[i].uploading || files[i].queued )\n                        to_upload += files[i].size;\n\n                // обвноляем состояние и статистику\n                return { \n                    files: files,\n                    uploading_now: true,\n                    upload_started: new Date(),\n                    total_to_upload: to_upload,\n                    uploaded_so_far: 0\n                };\n            }\n\n            // просто обновляем состояние\n            return { \n                files: files,\n                uploading_now: (uploads > 0),\n            };\n        });\n    }\n\n    onCancelFile(event){\n        event.preventDefault();\n        const index = event.target.id;\n        // обрываем закачку\n        if ( this.state.files[index].uploading )\n            this.state.files[index].ref.abort();\n        // асинхронно удаляем из состояния\n        this.setState( old_state =>{\n            const new_files = old_state.files;\n            const size = new_files[index].size;\n            new_files.splice(index, 1);\n            return { \n                files: new_files,\n                total_to_upload: old_state.total_to_upload - size,\n            };\n        });\n        // запускаем закачку следующих по очереди\n        this.rollQueue();\n    }\n\n    // Обновляем состояние при окончании загрузки файла\n    onFileUpoaded(name, json){\n        this.setState( old_state => {\n            const copy = old_state.files;\n            let size=0;\n            for (let i in copy){\n                const file =  copy[i];\n                if ( file.uploading && file.name === name ){\n                    if ( json.error !== undefined ){\n                        copy[i] = { name, error: true, error_text: json.error };\n                    }\n                    else {\n                        copy[i] = json; \n                    }\n                    size += file.size;\n                    break;\n                }\n            }\n            return ({ \n                files:           copy,\n                uploaded_so_far: old_state.uploaded_so_far+size,\n                total_uploaded:  old_state.total_uploaded+size,\n            });\n        });\n        // запускаем закачку следующих по очереди\n        this.rollQueue();\n    }\n\n    // Обновляем прогресс загрузки файла\n    onUploadProgress(name, progress){\n        this.setState( old_state => {\n            const copy = old_state.files;\n            for (let i in copy){\n                const file =  copy[i];\n                if ( file.uploading && file.name === name )\n                    copy[i].progress = progress;\n            }\n            return ( { files: copy });\n        });\n    }\n\n    // Ошибка загрузки,обновляем статус\n    onUploadError(name, text){\n        this.setState( old_state => {\n            const copy = old_state.files;\n            for (let i in copy){\n                const file =  copy[i];\n                if ( file.uploading && file.name === name )\n                    copy[i] =  { name, error: true, error_text: text }\n            }\n            return ( { files: copy });\n        });\n    }\n\n    render () {\n        // неавторизованных пользователей перенаправляем на страницу логина\n        if ( !isAuthenticated() )\n            return (<Redirect to={{ pathname: \"/login\", state: { from: this.props.location }}} />);\n\n        // готовим массив файлов - оснащаем коллбеками\n        const files = [];\n        for(let i in this.state.files ){\n            let file = this.state.files[i];\n            file.index = i;\n            file.callback = this.onCancelFile;\n            files.push(File(file));\n        }\n\n        return ([\n            <Navbar key='navbar' />,\n            <Breadcrumbs key='breadcrumbs' \n                parent_id = {this.state.parent_id}\n                parent_name = {this.state.parent_name}\n                name = {this.state.name}/>,\n            <main key='body' role=\"main\" className=\"container\">\n                <FolderStats stats={this.state}/>\n                <FileDropzone onFilesAdded={this.onFilesAdded}>\n                    <div className=\"list-group shadow\">\n                        {files}\n                    </div>\n                </FileDropzone>\n            </main>\n        ]);\n    }\n}\n","import React, { Component } from 'react';\nimport { Redirect }         from \"react-router-dom\";\nimport Navbar               from './Navbar';\nimport { isAuthenticated }  from './Login'\nimport Avatar               from './Avatar';\nimport API                  from './server_api'\nimport { getMe, updateMe }  from './Login';\n\n\nfunction UserDescription (props) {\n    const editing = props.state.editing;\n    return (\n        <div className=\"border border-light shadow-lg rounded-lg bg-white mt-4 p-4\">\n            <div className='d-flex'>\n                { props.state.is_loaded && <Avatar email={props.state.email} size='120' className='pr-4' /> }\n                <div className='flex-fill'>\n                    { editing !== 'name' &&\n                        <span className='d-flex justify-content-between'>\n                            <h1 className=\"display-4 text-break\">{props.state.name}</h1>\n                            <button className='close' disabled={ props.state.is_deleting || !props.state.is_loaded }>\n                                <img src='img/edit.svg' \n                                    className='align-self-start mt-0 ml-sm-5' \n                                    onClick={ props.state.is_deleting ? ()=>{} : props.clb.onEditNameButton } \n                                    alt='edit'/>\n                            </button>\n                        </span>\n                    }\n                    { editing === 'name' && \n                        <form className=\"form-inline mb-4\" onSubmit={ props.clb.onNameChangeButton } autoComplete=\"off\">\n                            <div className=\"form-group flex-grow-1\">\n                                <input type=\"text\" \n                                    className=\"form-control w-100 mr-2\"\n                                    id=\"nameEdit\" \n                                    maxLength='50'\n                                    autoFocus={true} \n                                    onChange={props.clb.handleInputChange}\n                                    value={ props.state.nameEdit }/>\n                            </div>\n                            <div>\n                                <button type=\"reset\" className=\"btn btn-secondary mr-2\" onClick={ props.clb.onCancelButton }>Отмена</button>\n                                <button type=\"submit\" className=\"btn btn-primary\">Изменить</button>\n                            </div>\n                        </form>\n                    }\n                    <span className='d-flex justify-content-between'>\n                        <p className=\"lead text-break\">{props.state.email}</p>\n                    </span>\n                </div>\n            </div>\n            <hr className=\"my-4\"/>\n            { !props.state.is_loaded ||\n                <p>Состоит в куче проектов, реальный чувак</p>\n            }\n            { !props.state.is_loaded || !getMe().is_admin || getMe().id === props.state.id ||\n                <button className=\"btn btn-danger btn-lg\" \n                disabled={ props.state.is_deleting } \n                onClick={ props.clb.onDeleteUser } >\n                    Удалить пользователя\n                </button>\n            }\n        </div>\n    );\n}\n\n\nexport default class User extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            is_loaded:   false,\n            editing:     'none',\n            name:        '',\n            email:       '',\n            is_deleting:  false,     // отослан запрос на удаление пользователя\n            is_deleted:   false,     // пришел ответ, что пользователь удален\n            me:           getMe(),\n        };\n\n        // способ отслеживания изменения URI и загрузи правильных данных\n        this.cached_id = this.props.match.params.id;\n\n        this.handleInputChange     = this.handleInputChange.bind(this);\n        this.onEditNameButton      = this.onEditNameButton.bind(this);\n        this.onNameChangeButton    = this.onNameChangeButton.bind(this);\n        this.onCancelButton        = this.onCancelButton.bind(this);\n        this.onDeleteUser          = this.onDeleteUser.bind(this);\n    }\n\n    loadUserInfo(){\n        // загружаем информацию о пользователе\n        API.getUser( (json)=>{ \n            json.is_loaded = true; // информация наконец загружена\n            this.setState( json ); \n        }, this.props.match.params.id );\n    }\n\n    componentWillMount() {\n        if ( isAuthenticated() )\n            this.loadUserInfo();\n    }\n\n    componentDidUpdate(){\n        // отслеживаем изменение ссылки, чтобы перезагрузить информацию о пользователе\n        if ( this.cached_id !== this.props.match.params.id ){\n            this.cached_id = this.props.match.params.id;\n            this.setState({ is_loaded: false })\n            this.loadUserInfo();\n        }\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        this.setState({ [target.id]: target.value });\n    }\n\n    onEditNameButton (event) {\n        this.setState( { editing: 'name', nameEdit: this.state.name });\n    }\n\n    onNameChangeButton (event) {\n        this.setState({ editing: 'none' });\n        API.updateUserName( ()=>{ \n            // если редактируем себя - обновляем\n            if ( getMe().id === this.props.match.params.id ) {\n                let json = getMe();\n                json.name = this.state.nameEdit;\n                updateMe(json);\n            }\n            this.setState({name: this.state.nameEdit, me: getMe()}); \n        }, this.props.match.params.id, this.state.nameEdit );\n        event.preventDefault();\n    }\n\n    onCancelButton (event) {\n        this.setState( { editing: 'none' });\n    }\n\n    onDeleteUser (event) {\n        this.setState( { editing: 'none', is_deleting: true });\n        API.deleteUser(()=>{ this.setState( { is_deleted: true }); }, this.props.match.params.id);\n        event.preventDefault();\n    }\n\n    render () {\n        // неавторизованных пользователей перенаправляем на страницу логина\n        if ( !isAuthenticated() )\n            return (<Redirect to={{ pathname: \"/login\", state: { from: this.props.location }}} />);\n\n        // после удаление проекта переходим к списку проектов снова\n        if ( this.state.is_deleted )\n            return (<Redirect to='/' />);\n        \n        return ([\n            <Navbar key='navbar' me={this.state.me} />,\n            <main key='body' role=\"main\" className=\"container\">\n                <UserDescription state= {this.state} clb={this} />\n            </main>\n        ]);\n    }\n}\n","import React, { Component } from 'react';\nimport { Redirect }         from \"react-router-dom\";\nimport Navbar               from './Navbar';\nimport { isAuthenticated }  from './Login'\nimport API                  from './server_api'\n\n\nexport default class NewProject extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            name:           '',\n            description:    '',\n            processing:     false,  // уже отправили запрос на сервер\n            processed:      false,  // уже получили ответ сервере\n            id:             '',     // id нового проекта\n        };\n\n        this.handleInputChange     = this.handleInputChange.bind(this);\n        this.onCreate              = this.onCreate.bind(this);\n        this.onCreated             = this.onCreated.bind(this);\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        this.setState({ [target.id]: target.value });\n    }\n\n    onCreate(event){\n        API.addProject(this.onCreated, this.state.name, this.state.description );\n        this.setState({ processing: true });\n        event.preventDefault();\n    }\n\n    onCreated(json) {\n        this.setState({ processed: true, id: json.id });\n    }\n\n    render() {\n        // неавторизованных пользователей перенаправляем на страницу логина\n        if ( !isAuthenticated() )\n            return (<Redirect to={{ pathname: \"/login\", state: { from: this.props.location }}} />);\n\n        // после получения ответа от сервера отправляем на сраницу настроек нового проекта\n        if ( this.state.processed )\n            return (<Redirect to={ '/project/'+this.state.id } />);\n\n        return ([\n            <Navbar key='navbar' />,\n            <main key='body' role=\"main\" className=\"container\">\n                <form onSubmit={this.onCreate} autoComplete=\"off\">\n                    <fieldset disabled={this.state.processing}>\n                        <h2 className='mt-3'>Создать новый проект</h2>\n                        <div className=\"form-group\">\n                            <input type=\"text\" \n                                className=\"form-control\"\n                                id=\"name\" \n                                placeholder=\"Введите название\" \n                                onChange={this.handleInputChange}\n                                value={this.state.name}\n                                required />\n                        </div>\n                        <div className=\"form-group\">\n                            <textarea className=\"form-control\"\n                                id=\"description\" \n                                rows=\"3\" \n                                placeholder=\"Описание проекта (не обязательно)\" \n                                onChange={this.handleInputChange}\n                                value={this.state.description} />\n                        </div>\n                        <button type=\"submit\" className=\"btn btn-primary\">Создать</button>\n                    </fieldset>\n                </form>\n            </main>\n        ]);\n    }\n}\n","import React, { Component } from 'react';\nimport { Redirect, Link }   from \"react-router-dom\";\nimport Navbar               from './Navbar';\nimport { isAuthenticated }  from './Login'\nimport Breadcrumbs          from './Breadcrumbs';\nimport Avatar               from './Avatar';\nimport API                  from './server_api'\nimport { getMe }            from './Login';\n\nimport TimeAgo              from 'react-timeago';\nimport ruStrings            from 'react-timeago/lib/language-strings/ru'\nimport buildFormatter       from 'react-timeago/lib/formatters/buildFormatter'\n\nimport './Project.css'\n\nconst formatter = buildFormatter(ruStrings);\n\nfunction emailIsValid (email) {\n    if (email === undefined)\n        return false;\n    const e = email.trim();\n    const regexp = /\\S+@\\S+\\.((?:com)|(?:ru))/;\n    const m = e.match(regexp);\n    //  есть совпадение и оно полное\n    return ( m !== null && m[0] === e );\n}\n\nfunction User (props) {\n    const icon = (props.icon==='add') ? 'img/add-user.svg' : 'img/delete-user.svg';\n    const animated = props.animated ? \"user-animated\" : \"\";\n    return (\n        <li className={\"list-group-item d-flex align-items-center \"+ animated} >\n            <Avatar email={props.user.email} size='80' />\n            <div className='flex-grow-1 text-break ml-3'>\n                <Link to={'/user/' + props.user.id} className='text-dark'>\n                    <h5>{props.user.name}</h5>\n                    <span>{props.user.email}</span>\n                </Link>\n            </div>\n            <button className='close' id={props.user.id} onClick={props.func}>\n                <img src={icon} id={props.user.id} height=\"50px\" className='ml-2' alt='move user'/>\n            </button>\n        </li>\n    );\n}\n\nfunction NewUser (props) {\n    const editing = props.state.editing;\n    // валидируем введенный емейл\n    const email_valid = emailIsValid(props.state.user_email);\n    return (\n        <li className=\"list-group-item d-flex align-items-center justify-content-center\">\n            { editing === 'user' ||\n                <button className='close'>\n                    <img src='img/add-new-user.svg' \n                    onClick={ props.onNewUserButton } \n                    height=\"50px\"\n                    alt='edit'/>\n                </button>\n            }\n            { editing === 'user' &&\n                <form className=\"form-inline\" onSubmit={ props.onCreateUserButton } autoComplete=\"off\">\n                    <div className=\"form-row w-100\">\n                        <div className=\"input-group mb-2 col-sm-6\">\n                            <input type=\"text\" \n                                className=\"form-control\" \n                                id=\"user_name\" \n                                placeholder=\"Имя\" \n                                maxLength='50'\n                                onChange={props.handleInputChange}\n                                value={props.state.user_name}\n                                required/>\n                        </div>\n                        <div className=\"input-group mb-2 col-sm-6\">\n                            <div className=\"input-group-prepend\">\n                                <div className=\"input-group-text\">@</div>\n                            </div>\n                            <input type=\"email\" \n                                className={\"form-control \" + (email_valid ? \"is-valid\" :\"is-invalid\")}\n                                id=\"user_email\" \n                                placeholder=\"Email\"\n                                maxLength='50'\n                                onChange={props.handleInputChange}\n                                value={props.state.user_email}\n                                required />\n                        </div>\n                    </div>\n                    <div className=\"form-row px-1\">\n                        <button type=\"reset\" className=\"btn btn-secondary mr-2\" onClick={ props.onCancelButton }>Отмена</button>\n                        <button type=\"submit\" className={\"btn btn-primary\" + ( email_valid?\"\":\" disabled\")}>\n                            Создать\n                        </button>\n                    </div>\n                </form>\n            }\n        </li>\n    )\n}\n\nfunction ProjectDescription (props) {\n    const editing = props.state.editing;\n    return (\n        <div className=\"border border-light shadow-lg rounded-lg bg-white mt-4 p-4\">\n            { editing !== 'name' &&\n                <span className='d-flex justify-content-between'>\n                    <h1 className=\"display-4 text-break\">{props.state.name}</h1>\n                    { !getMe().is_admin ||  props.state.folders_num > 0 ||\n                        <button className='close' disabled={ props.state.is_deleting || !props.state.is_loaded }>\n                            <img src='img/edit.svg' \n                                className='align-self-start mt-4 ml-3' \n                                onClick={ props.state.is_deleting ? ()=>{} : props.clb.onEditNameButton } \n                                alt='edit'/>\n                        </button>\n                    }\n                </span>\n            }\n            { editing === 'name' && \n                <form className=\"form-inline mb-4\" onSubmit={ props.clb.onNameChangeButton } autoComplete=\"off\">\n                    <div className=\"form-group flex-grow-1\">\n                        <input type=\"text\" \n                            className=\"form-control w-100 mr-2\" \n                            id=\"nameEdit\" \n                            autoFocus={true} \n                            onChange={props.clb.handleInputChange}\n                            value={ props.state.nameEdit }/>\n                    </div>\n                    <div>\n                        <button type=\"reset\" className=\"btn btn-secondary mr-2\" onClick={ props.clb.onCancelButton }>Отмена</button>\n                        <button type=\"submit\" className=\"btn btn-primary\">Изменить</button>\n                    </div>\n                </form>\n            }\n            { editing !== 'description' &&                    \n                <span className='d-flex justify-content-between'>\n                    <p className=\"lead text-break\">{props.state.description}</p>\n                    { !getMe().is_admin ||\n                        <button className='close' disabled={ props.state.is_deleting || !props.state.is_loaded }>\n                            <img src='img/edit.svg' \n                                className='align-self-start mt-3 ml-3' \n                                onClick={ props.state.is_deleting ? ()=>{} : props.clb.onEditDescButton }  \n                                alt='edit'/>\n                        </button>\n                    }\n                </span>\n            }\n            { editing === 'description' && \n                <form className=\"form form mb-4\" onSubmit={ props.clb.onDescChangeButton } autoComplete=\"off\">\n                    <div className=\"form-group flex-grow-1 mr-sm-4\">\n                        <textarea className=\"form-control w-100\" \n                            id=\"descEdit\"\n                            rows=\"5\"\n                            autoFocus={true} \n                            onChange={props.clb.handleInputChange}\n                            value={props.state.descEdit}/>\n                    </div>\n                    <div>\n                        <button type=\"reset\" className=\"btn btn-secondary mr-2\" onClick={ props.clb.onCancelButton }>Отмена</button>\n                        <button type=\"submit\" className=\"btn btn-primary\">Изменить</button>\n                    </div>\n                </form>\n            }                    \n            <hr className=\"my-4\"/>\n            { !props.state.is_loaded ||\n                <p>Создан <strong><TimeAgo date={props.state.created} formatter={formatter}/></strong><br />\n                Содержит <strong>{props.state.folders_num} папки</strong>, <strong>{props.state.files_num} файла(ов)</strong>.</p>\n            }\n            { props.state.folders_num > 0 || !props.state.is_loaded || !getMe().is_admin ||\n                <button className=\"btn btn-danger btn-lg\" \n                disabled={ props.state.is_deleting } \n                onClick={ props.clb.onDeleteProject } >\n                    Удалить проект\n                </button>\n            }\n        </div>\n    );\n}\n\n\n\nexport default class Project extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            is_loaded:   false,\n            editing:     'none',\n            name:        '',\n            description: '',\n            participants: new Set(), // id's of selected users\n            users:        [],        // все пользователи сервиса\n            moved_user:   '',        // id перемещенного пользвателся (для анимации)\n            is_deleting:  false,     // отослан запрос на удаление проекта\n            is_deleted:   false,     // пришел ответ, что проект удален\n        };\n\n        this.handleInputChange     = this.handleInputChange.bind(this);\n        this.onEditNameButton      = this.onEditNameButton.bind(this);\n        this.onNameChangeButton    = this.onNameChangeButton.bind(this);\n        this.onEditDescButton      = this.onEditDescButton.bind(this);\n        this.onDescChangeButton    = this.onDescChangeButton.bind(this);\n        this.onCancelButton        = this.onCancelButton.bind(this);\n        this.onAddUser             = this.onAddUser.bind(this);\n        this.onDeleteUser          = this.onDeleteUser.bind(this);\n        this.onNewUserButton       = this.onNewUserButton.bind(this);\n        this.onCreateUserButton    = this.onCreateUserButton.bind(this);\n        this.onProjectLoaded       = this.onProjectLoaded.bind(this);\n        this.onUserCreated         = this.onUserCreated.bind(this);\n        this.onDeleteProject       = this.onDeleteProject.bind(this);\n    }\n\n    onProjectLoaded(json) {\n        let newstate = json;\n        if ( 'users' in json ){\n            newstate.participants = new Set(json.users);\n            delete newstate.users;\n        }\n        newstate.is_loaded = true; // информация наконец загружена\n        this.setState( newstate );\n    }\n\n    componentWillMount() {\n        if ( isAuthenticated() ){\n            API.getProject( this.onProjectLoaded, this.props.match.params.id );\n            if ( getMe().is_admin )\n                API.getUsersList( (json) => { this.setState( { users: json }); } );\n        }\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        this.setState({ [target.id]: target.value });\n    }\n\n    onEditNameButton (event) {\n        this.setState( { editing: 'name', nameEdit: this.state.name });\n    }\n\n    onNameChangeButton (event) {\n        API.updateProject(this.onProjectLoaded, this.props.match.params.id, this.state.nameEdit, this.state.description );\n        this.setState( { editing: 'none' });\n        event.preventDefault();\n    }\n\n    onEditDescButton (event) {\n        this.setState( { editing: 'description', descEdit: this.state.description });\n    }\n\n    onDescChangeButton (event) {\n        API.updateProject(this.onProjectLoaded, this.props.match.params.id, this.state.name, this.state.descEdit );\n        this.setState( { editing: 'none' });\n        event.preventDefault();\n    }\n\n    onNewUserButton (event) {\n        this.setState( { editing: 'user', user_name: '', user_email: '' });\n    }\n\n    onCancelButton (event) {\n        this.setState( { editing: 'none' });\n    }\n\n    onAddUser (event) {\n        let sel = this.state.participants;\n        sel.add(event.target.id);\n        API.updateUserProjects(()=>{}, event.target.id, this.props.match.params.id, 'add');\n        this.setState( { editing: 'none', participants: sel, moved_user: event.target.id });\n        event.preventDefault();\n    }\n\n    onDeleteUser (event) {\n        let sel = this.state.participants;\n        sel.delete(event.target.id);\n        API.updateUserProjects(()=>{}, event.target.id, this.props.match.params.id, 'delete');\n        this.setState( { editing: 'none', participants: sel, moved_user: event.target.id });\n        event.preventDefault();\n    }\n\n    onUserCreated (json) {\n        let new_users = this.state.users;\n        let sel = this.state.participants;\n\n        new_users.push(json);\n        sel.add(json.id);\n\n        this.setState( { \n            participants: sel,\n            users: new_users,\n            moved_user: json.id,\n            editing: 'none',\n        });\n    }\n\n    onCreateUserButton (event) {\n        API.addUser(this.onUserCreated, this.state.user_name,  this.state.user_email.trim(), this.props.match.params.id );\n        this.setState( { editing: 'none', });\n        event.preventDefault();\n    }\n\n    onDeleteProject (event) {\n        API.deleteProject(()=>{ this.setState( { is_deleted: true }); }, this.props.match.params.id);\n        this.setState( { editing: 'none', is_deleting: true });\n        event.preventDefault();\n    }\n\n    render () {\n        // неавторизованных пользователей перенаправляем на страницу логина\n        if ( !isAuthenticated() )\n            return (<Redirect to={{ pathname: \"/login\", state: { from: this.props.location }}} />);\n\n        // после удаление проекта переходим к списку проектов снова\n        if ( this.state.is_deleted )\n            return (<Redirect to='/' />);\n\n\n        // составляем два списка пользователей\n        let participants = [];\n        let others = [];\n\n        for (let i in this.state.users){\n            const p = this.state.users[i];\n            const animated = (p.id === this.state.moved_user);\n\n            if ( p.is_admin ) {\n                // игнорируем, у админов есть доступ везде\n            }\n            else if (this.state.participants.has(this.state.users[i].id))\n                participants.push(<User icon='delete' user={p} key={p.id} func={this.onDeleteUser} animated={animated}/>);\n            else\n                others.push(<User icon='add' user={p} key={p.id} func={this.onAddUser} animated={animated}/>);\n        }\n        \n        return ([\n            <Navbar key='navbar' />,\n            <Breadcrumbs key='breadcrumbs' name = {this.state.name}/>,            \n            <main key='body' role=\"main\" className=\"container\">\n                <ProjectDescription state= {this.state} clb={this} />\n                { !this.state.is_loaded || this.state.is_deleting || !getMe().is_admin ||\n                    <div className='d-flex flex-column flex-lg-row'>\n                        <div className='flex-fill my-4 mr-lg-4'>\n                            <h2 className='ml-3'>Участники проекта:</h2>\n                            <ul className=\"list-group shadow-lg\">\n                                {participants}\n                                <NewUser state={this.state}\n                                    handleInputChange={this.handleInputChange}\n                                    onNewUserButton={this.onNewUserButton}\n                                    onCreateUserButton={this.onCreateUserButton}\n                                    onCancelButton={this.onCancelButton} />\n                            </ul>\n                        </div>\n                        <div className='flex-fill my-4 ml-lg-4'>\n                            <h2 className='ml-3'>Остальные пользователи:</h2>\n                            <ul className=\"list-group shadow-lg\">\n                                {others}\n                            </ul>\n                        </div>\n                    </div>\n                }\n            </main>\n        ]);\n    }\n}\n","import React     from 'react';\nimport ReactDOM  from 'react-dom';\n\nimport App       from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));","import React                              from 'react';\nimport { HashRouter as Router, Route }    from 'react-router-dom';\nimport Projects                           from './ProjectsList'\nimport Folder                             from './Folder';\nimport User                               from './User';\nimport NewProject                         from './NewProject';\nimport Project                            from './Project';\nimport { Login, Logout }                  from './Login'\nimport Alert                              from './Alert';\n\nexport default function App(props){\n    // ну а пока суть да дело - рисуем что можем\n    return (\n        <Router>\n            <div className=\"App\">\n                <Route exact path=\"/\" component={Projects} />\n                <Route path=\"/login\" component={Login} />\n                <Route path=\"/access_token=:hash\" component={Login} />\n                <Route path=\"/logout\" component={Logout} />\n                <Route path=\"/new_project\" component={NewProject} />\n                <Route path=\"/folder/:id\" render={ (props) => <Folder {...props}/> } />\n                <Route path=\"/project/:id\" render={ (props) => <Project {...props}/> } />\n                <Route path=\"/user/:id\" render={ (props) => <User {...props}/> } />\n                <Alert />\n            </div>\n        </Router>\n    );\n}"],"sourceRoot":""}